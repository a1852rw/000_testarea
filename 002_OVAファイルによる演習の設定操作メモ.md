# OVAファイルに夜演習の設定操作メモ
## 操作環境
- 受領したOVAファイルにより構築した環境
- VirtualBoxにて実施
- ターミナルはVisual Studio Codeを使用(詳しい設定は後述)

## 実施すべき設定(設定後にキャプチャを取得)
- P5：SELinuxを有効に設定：有効であることを示すキャプチャを撮影
- P8：ファイアウォール設定
    - firewall-cmdコマンドの–list-all-zonesオプションで確認できるキャプチャ
    - 撮影が必要なのかは後程検討
- P10：2項目の設定とキャプチャを撮影
    - rootユーザでログイン不可
    - パスワード認証を⽌め，鍵認証にする
- P11：2項目の設定とキャプチャ撮影
    - suコマンドでrootにならず，sudoを使う
    - rootでのログインを制限する
- P18：Auditの設定とキャプチャ撮影
- その他サーバ要塞化として行った設定
    - OSとパッケージの最新化
    - 不要なサービスの停止
    - 不要なポートの閉鎖
    - ウェルノウンポートを使ったアクセスを行わない(SSHなどのアクセスに使用するポート番号の変更)
    - アクセス元IPアドレス制限
    - NTPによる時刻情報の同期

## 実際の操作と設定/キャプチャ撮影の手順
### OVAファイルインストールとSSH設定
- P33
    - 事前準備を参照しインポート：OK
- スナップショットの作成 (001_最初期の状態)
- P42
    - rootユーザでログイン：OK
    - 一般ユーザでログイン：OK
- P43ログイン操作
    - VisualStudioCodeにて操作
    - Ctrl + @ でターミナルを表示 (Widows power Shell)
    - ssh -p 2222 cysec@localhost

```txt
The authenticity of host '[localhost]:2222 ([127.0.0.1]:2222)' can't be established.
ECDSA key fingerprint is SHA256:RjwSOYCCLRNyPxtRyzjeqDipsxIHQFVXbHk7w7zRs7I.        
Are you sure you want to continue connecting (yes/no/[fingerprint])? 
```
- 「yes」を選択

```txt
Warning: Permanently added '[localhost]:2222' (ECDSA) to the list of known hosts.
cysec@localhost's password: 
```
- passwordにスライドP42に記載のパスワードを入力
- SSHによるログイン成功

- P44
    - ブラウザからP44に記載のURLにアクセス
    - 目的のページが表示された = 成功

## スナップショット取得(2回目)
- 


## セキュリティ設定とキャプチャ
### P5 Selinuxが有効であることを確認
- sudo less /etc/selinux/config
    - SELINUX=permissive と表示された = アクセス制御されない = NG
    - Enforcing に変更する
- sudo yum -y install vim
    - vim をインストールして設定を編集
- sudo vim /etc/selinux/config
    - SELINUX=permissive を　SELINUX=Enforcing に手動で書き換え
- sudo reboot now
    - 設定を反映するため再起動
- getenforce
    - Enforcing と表示されたので設定成功

#### P6 設定内容の確認
- スナップショット名「演習準備完了」で保存


## 参考ページ
- 

